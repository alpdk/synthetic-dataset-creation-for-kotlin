# Synthetic Dataset Creation For Kotlin

## Preparations

### Python packages

For proper work this code will require from user packages:

1. datasets
2. jsonlines
3. peft

For their installation we will run this line in terminal:

```pip install datasets jsonlines peft > /dev/null```

### Kotlinc 

Kotlinc required for running code that was generated by LLM. 
For setting it up we will run script `setup_kotlinc.py`.

This script has 1 parameter:

1. Github link to kotlinc zip archive. (by default: [link](https://github.com/JetBrains/kotlin/releases/download/v2.0.20/kotlin-compiler-2.0.20.zip))

This zip archive will be placed in project directory.

You can run this scrypt like:

1. ```python setup_kotlinc.py```
2. ```python setup_kotlinc.py [link]```

### MXeval

MXeval required for testing generated code. 
For setting it up we will run script `setup_mxeval.py`.

This script has 1 parameter: 

1. Full path to directory where MXeval will be placed or already placed. (default: project dir) 

You can run this scrypt like:

1. ```python setup_mxeval.py```
2. ```python setup_mxeval.py [path]```

## Test not fine tuned llm model

Before we will start fine tuning llm we need to check what pass rate it has on our testing dataset.
For that we will run script `generate_model_answer.py`

This script has 2 parameters:

1. Name of the model or local path to it. (default: `ibm-granite/granite-3b-code-base-2k` )
2. Dataset for testing. (default: `jetbrains/Kotlin_HumanEval` )

There are 3 ways to run this scrypt like:

1. ```python generate_model_answers.py```
2. ```python generate_model_answers.py [model name/local path]```
3. ```python generate_model_answers.py [model name/local path] [dataset name]```

As a result it will give you a pass rate on tests and file `answer` with results for each test.

## Generate synthetic dataset for fine tuning

There we want to generate high quality dataset for llm model fine tuning.
For generation of it we will use scrypt `create_synt_data.py`.
This scrypt take code in python and translate it to kotlin.

This scrypt has 3 parameters:

1. Max count of elements that will be in dataset. (default: 100)
2. Model name for translation of code. (default: ibm-granite/granite-3b-code-base-2k)
3. Dataset name that will be translated. (default: jinaai/code_exercises)

There are 3 ways to run this scrypt like:

1. ```python create_synt_data.py```
2. ```python create_synt_data.py [integer count of elements to translate]```
3. ```python create_synt_data.py [[integer count of elements to translate]] [model name]```
4. ```python create_synt_data.py [[integer count of elements to translate]] [model name] [dataset name]```


